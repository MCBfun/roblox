--[[
	WARNING: Heads up! This script has not been verified by ScriptBlox. Use at your own risk!
]]
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer

-- GUI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RagdollGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 140, 0, 40)
button.Position = UDim2.new(0, 20, 0, 20)
button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
button.TextColor3 = Color3.new(1, 1, 1)
button.Text = "Toggle Ragdoll"
button.Font = Enum.Font.SourceSansBold
button.TextSize = 18
button.Parent = screenGui

-- State
local isRagdolled = false
local motorBackup = {}

local function getCharacter()
	return player.Character or player.CharacterAdded:Wait()
end

-- Ragdoll function
local function toggleRagdoll()
	local character = getCharacter()
	local humanoid = character:FindFirstChildOfClass("Humanoid")
	if not humanoid or humanoid.Health <= 0 then return end

	local root = character:FindFirstChild("HumanoidRootPart")
	if not root then return end

	if not isRagdolled then
		-- Disable humanoid states to allow physics to take over
		humanoid:ChangeState(Enum.HumanoidStateType.Physics)
		humanoid.AutoRotate = false

		-- Store original joints
		motorBackup = {}

		for _, joint in ipairs(character:GetDescendants()) do
			if joint:IsA("Motor6D") then
				local socket = Instance.new("BallSocketConstraint")
				local a1 = Instance.new("Attachment")
				local a2 = Instance.new("Attachment")

				a1.CFrame = joint.C0
				a2.CFrame = joint.C1
				a1.Parent = joint.Part0
				a2.Parent = joint.Part1

socket.Attachment0=a1
socket.Attachment1=a2
套接字.父代=接头.父代
socket.LimitsEnabled=true
socket.TwistLimitsEnabled=true

motorBackup[joint.Name.."_"..joint:getFullName()]={
Part0=接头。Part0，
第1部分=接头。第1部分，
C0=接头.C0，
C1=接头C1，
parent=joint.Parent，
				}

接头：销毁()
结束
结束

--首先施加轻微向上的速度使其下降
root.Velocity=Vector3.new(0，15，0)

isRagdolled=true
button.Text="展开玩偶"

其他
--恢复电机
对于_，成对数据(motorBackup)
本地电机=Instance.new("Motor6D")
motor.Name="恢复的电机"
motor.Part0=data.Part0
motor.Part1=data.Part1
motor.C0=data.C0
motor.C1=data.C1
motor.Parent=data.Parent
结束
motorBackup={}

类人：changeState(枚举.HumanoidStateType.GettingUp)
humanoid.AutoRotate=true

--拆除剩余附件/插座
for_，ipairs中的item(字符：GetDescendants())do
如果项目：Isa(“BallSocketConstraint”)或项目：Isa(“Attachment”)，则
项目：销毁()
结束
结束

isRagdolled=false
button.Text="切换碎布玩偶"
结束
结束

--重生时恢复
player.CharacterAdded:Connect(函数(char)
isRagdolled=false
motorBackup={}
button.Text="切换碎布玩偶"
结束)

按钮.鼠标按钮1单击：连接(toggleRagdoll)
