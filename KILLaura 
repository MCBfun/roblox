-- æç®€è‡ªç„+ä¼ é€+æ”»å‡»è„šæœ¬ - ä¸‰ä¸ªåŠŸèƒ½åˆä¸€
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local isRunning = true
local camera = Workspace.CurrentCamera

-- åˆ›å»ºæœ€å°åŒ–UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SimpleAimbotGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 120, 0, 100)  -- æœ€å°å°ºå¯¸
mainFrame.Position = UDim2.new(0.5, -60, 0.5, -50)  -- å±…ä¸­
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
mainFrame.BackgroundTransparency = 0.2
mainFrame.BorderSizePixel = 1
mainFrame.BorderColor3 = Color3.fromRGB(80, 80, 100)
mainFrame.Active = false
mainFrame.Draggable = false
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

-- æ ‡é¢˜æ 
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 25)
titleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local title = Instance.new("TextLabel")
title.Text = "killaura"
title.Size = UDim2.new(1, -50, 1, 0)
title.Position = UDim2.new(0, 5, 0, 0)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Font = Enum.Font.SourceSansSemibold
title.TextSize = 14
title.Parent = titleBar

-- ç¼©å°æŒ‰é’®
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Name = "MinimizeButton"
minimizeBtn.Size = UDim2.new(0, 25, 0, 25)
minimizeBtn.Position = UDim2.new(1, -50, 0, 0)
minimizeBtn.Text = "_"
minimizeBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
minimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeBtn.Font = Enum.Font.SourceSansBold
minimizeBtn.TextSize = 16
minimizeBtn.Parent = titleBar

-- å…³é—­æŒ‰é’®
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 25, 0, 25)
closeBtn.Position = UDim2.new(1, -25, 0, 0)
closeBtn.Text = "Ã—"
closeBtn.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 16
closeBtn.Parent = titleBar

-- ä¸‰ä¸ªåˆä¸€æŒ‰é’®
local comboButton = Instance.new("TextButton")
comboButton.Name = "ComboButton"
comboButton.Size = UDim2.new(1, -10, 1, -35)
comboButton.Position = UDim2.new(0, 5, 0, 30)
comboButton.Text = "ğŸ”´ off\nkillaura"
comboButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
comboButton.TextColor3 = Color3.fromRGB(255, 255, 255)
comboButton.Font = Enum.Font.SourceSansSemibold
comboButton.TextSize = 16
comboButton.TextWrapped = true
comboButton.Parent = mainFrame

-- çŠ¶æ€æ˜¾ç¤ºï¼ˆç¼©å°åï¼‰
local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(1, -10, 1, -10)
statusLabel.Position = UDim2.new(0, 5, 0, 5)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "killaura\nç‚¹å‡»å±•å¼€"
statusLabel.TextColor3 = Color3.fromRGB(200, 200, 220)
statusLabel.TextSize = 12
statusLabel.TextWrapped = true
statusLabel.Visible = false
statusLabel.Parent = mainFrame

-- å˜é‡
local isComboActive = false  -- ä¸‰åˆä¸€çŠ¶æ€
local maxDistance = 50  -- å›ºå®šæœç´¢è·ç¦»
local teleportHeight = 0  -- å›ºå®šä¼ é€é«˜åº¦
local currentTarget = nil
local lastAttackTime = 0
local attackRate = 5  -- å›ºå®šæ”»å‡»é¢‘ç‡
local isMinimized = false
local originalSize = mainFrame.Size
local minimizedSize = UDim2.new(0, 80, 0, 40)  -- æ›´å°çš„ç¼©å°æ¨¡å¼
local minimizedPosition = UDim2.new(0.5, -40, 0.5, -20)

-- ç¼©å°åŠŸèƒ½
minimizeBtn.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    
    if isMinimized then
        mainFrame.Size = minimizedSize
        mainFrame.Position = minimizedPosition
        comboButton.Visible = false
        statusLabel.Visible = true
        minimizeBtn.Text = "+"
        title.Text = "ğŸ¯"
        
        if isComboActive then
            statusLabel.Text = "killaura\nè¿è¡Œä¸­"
        else
            statusLabel.Text = "killaura\nå·²å…³é—­"
        end
    else
        mainFrame.Size = originalSize
        mainFrame.Position = UDim2.new(0.5, -60, 0.5, -50)
        comboButton.Visible = true
        statusLabel.Visible = false
        minimizeBtn.Text = "_"
        title.Text = "killaura"
    end
end)

-- å…³é—­åŠŸèƒ½
closeBtn.MouseButton1Click:Connect(function()
    screenGui:Destroy()
    isRunning = false
end)

-- ä¸‰åˆä¸€æŒ‰é’®åŠŸèƒ½
comboButton.MouseButton1Click:Connect(function()
    isComboActive = not isComboActive
    
    if isComboActive then
        comboButton.Text = "ğŸŸ¢ on\nkillaura"
        comboButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
        if isMinimized then
            statusLabel.Text = "killaura\nè¿è¡Œä¸­"
        end
    else
        comboButton.Text = "ğŸ”´ off\nkillaura"
        comboButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
        currentTarget = nil
        if isMinimized then
            statusLabel.Text = "killaura\nå·²å…³é—­"
        end
    end
end)

-- è·å–æœ€è¿‘ç©å®¶
local function getNearestPlayer()
    local character = player.Character
    if not character then return nil end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return nil end
    
    local myPos = rootPart.Position
    local nearestPlayer = nil
    local nearestDistance = maxDistance
    
    for _, otherPlayer in ipairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local otherRoot = otherPlayer.Character:FindFirstChild("HumanoidRootPart")
            if otherRoot then
                local distance = (otherRoot.Position - myPos).Magnitude
                if distance <= nearestDistance then
                    nearestDistance = distance
                    nearestPlayer = {
                        Player = otherPlayer,
                        Character = otherPlayer.Character,
                        Distance = distance,
                        Position = otherRoot.Position
                    }
                end
            end
        end
    end
    
    return nearestPlayer
end

-- æ‰§è¡Œä¸‰åˆä¸€åŠŸèƒ½
local function performCombo()
    if not isComboActive then return false end
    
    local target = getNearestPlayer()
    currentTarget = target
    
    if target then
        -- 1. è‡ªç„ï¼ˆç„å‡†å¤´éƒ¨ï¼‰
        local head = target.Character:FindFirstChild("Head")
        local aimPosition = head and head.Position or target.Position
        
        local cameraCFrame = camera.CFrame
        local targetDirection = (aimPosition - cameraCFrame.Position).Unit
        local currentLook = cameraCFrame.LookVector
        local smoothedDirection = currentLook:Lerp(targetDirection, 0.5)
        camera.CFrame = CFrame.new(cameraCFrame.Position, cameraCFrame.Position + smoothedDirection)
        
        -- 2. ä¼ é€ï¼ˆåˆ°ç›®æ ‡ä¸Šæ–¹ï¼‰
        local character = player.Character
        if character then
            local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
            if humanoidRootPart then
                local teleportPos = target.Position + Vector3.new(0, teleportHeight * 4, 0)
                humanoidRootPart.CFrame = CFrame.new(teleportPos)
            end
        end
        
        -- 3. æ”»å‡»ï¼ˆè‡ªåŠ¨å·¦é”®ï¼‰
        local currentTime = tick()
        if currentTime - lastAttackTime >= (1 / attackRate) then
            pcall(function()
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 1)
                task.wait(0.05)
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 1)
            end)
            lastAttackTime = currentTime
        end
        
        -- æ›´æ–°ç¼©å°çŠ¶æ€
        if isMinimized then
            statusLabel.Text = string.format("killaura\n%s", target.Player.Name)
        end
        
        return true
    else
        if isMinimized then
            statusLabel.Text = "killaura\næ— ç›®æ ‡"
        end
        return false
    end
end

-- ä¸»å¾ªç¯
RunService.Heartbeat:Connect(function()
    if not isRunning then return end
    performCombo()
end)

-- å¿«æ·é”®
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    -- ç©ºæ ¼é”®ï¼šå¼€å…³ä¸‰åˆä¸€
    if input.KeyCode == Enum.KeyCode.Space then
        isComboActive = not isComboActive
        
        if isComboActive then
            comboButton.Text = "ğŸŸ¢ on\n killaura"
            comboButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
            if isMinimized then
                statusLabel.Text = "killaura\nè¿è¡Œä¸­"
            end
        else
            comboButton.Text = "ğŸ”´ off\n killaura"
            comboButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
            currentTarget = nil
            if isMinimized then
                statusLabel.Text = "killaura\nå·²å…³é—­"
            end
        end
    end
    
    -- Mé”®ï¼šç¼©å°/æ”¾å¤§
    if input.KeyCode == Enum.KeyCode.M then
        isMinimized = not isMinimized
        
        if isMinimized then
            mainFrame.Size = minimizedSize
            mainFrame.Position = minimizedPosition
            comboButton.Visible = false
            statusLabel.Visible = true
            minimizeBtn.Text = "+"
            title.Text = "æ¸”ç‚’é±¼"
            
            if isComboActive then
                statusLabel.Text = "killaura\nè¿è¡Œä¸­"
            else
                statusLabel.Text = "killaura\nå·²å…³é—­"
            end
        else
            mainFrame.Size = originalSize
            mainFrame.Position = UDim2.new(0.5, -60, 0.5, -50)
            comboButton.Visible = true
            statusLabel.Visible = false
            minimizeBtn.Text = "_"
            title.Text = "killaura "
        end
    end
end)

print("=== killauraè„šæœ¬å·²åŠ è½½ ===")
print("killaura")
print("æ“ä½œ:")
print("- ç‚¹å‡»å¤§æŒ‰é’®æˆ–æŒ‰ç©ºæ ¼é”®å¼€å…³")
print("- ç‚¹å‡»_æŒ‰é’®æˆ–æŒ‰Mé”®ç¼©å°")
print("- ç¼©å°åæ˜¾ç¤ºçŠ¶æ€")
print("å‚æ•°:")
print("- æœç´¢è·ç¦»: 50ç±³(å›ºå®š)")
print("- ä¼ é€é«˜åº¦: 5æ ¼(å›ºå®š)")
print("- æ”»å‡»é¢‘ç‡: 5æ¬¡/ç§’(å›ºå®š)")