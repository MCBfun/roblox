-- æç®€è‡ªç„+ä¼ é€+æ”»å‡»è„šæœ¬ - ä¸‰ä¸ªåŠŸèƒ½åˆä¸€ï¼ˆå¿½ç•¥ä½è¡€é‡ï¼‰
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local isRunning = true
local camera = Workspace.CurrentCamera

-- åˆ›å»ºæœ€å°åŒ–UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SimpleAimbotGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 120, 0, 140)  -- å¢åŠ é«˜åº¦ä»¥å®¹çº³æ–°æŒ‰é’®
mainFrame.Position = UDim2.new(0.5, -60, 0.5, -70)  -- è°ƒæ•´ä½ç½®
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
mainFrame.BackgroundTransparency = 0.2
mainFrame.BorderSizePixel = 1
mainFrame.BorderColor3 = Color3.fromRGB(80, 80, 100)
mainFrame.Active = false
mainFrame.Draggable = false
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

-- æ ‡é¢˜æ 
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 25)
titleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local title = Instance.new("TextLabel")
title.Text = "killaura"
title.Size = UDim2.new(1, -50, 1, 0)
title.Position = UDim2.new(0, 5, 0, 0)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Font = Enum.Font.SourceSansSemibold
title.TextSize = 14
title.Parent = titleBar

-- ç¼©å°æŒ‰é’®
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Name = "MinimizeButton"
minimizeBtn.Size = UDim2.new(0, 25, 0, 25)
minimizeBtn.Position = UDim2.new(1, -50, 0, 0)
minimizeBtn.Text = "_"
minimizeBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
minimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeBtn.Font = Enum.Font.SourceSansBold
minimizeBtn.TextSize = 16
minimizeBtn.Parent = titleBar

-- å…³é—­æŒ‰é’®
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 25, 0, 25)
closeBtn.Position = UDim2.new(1, -25, 0, 0)
closeBtn.Text = "Ã—"
closeBtn.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 16
closeBtn.Parent = titleBar

-- ä¸‰ä¸ªåˆä¸€æŒ‰é’®
local comboButton = Instance.new("TextButton")
comboButton.Name = "ComboButton"
comboButton.Size = UDim2.new(1, -10, 0, 40)  -- è°ƒæ•´å¤§å°
comboButton.Position = UDim2.new(0, 5, 0, 30)
comboButton.Text = "è‡ªç„+ä¼ é€+æ”»å‡»\næ€æˆ®å…‰ç¯"
comboButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
comboButton.TextColor3 = Color3.fromRGB(255, 255, 255)
comboButton.Font = Enum.Font.SourceSansSemibold
comboButton.TextSize = 14
comboButton.TextWrapped = true
comboButton.Parent = mainFrame

-- è½®æµä¼ é€æŒ‰é’®
local cycleTeleportButton = Instance.new("TextButton")
cycleTeleportButton.Name = "CycleTeleportButton"
cycleTeleportButton.Size = UDim2.new(1, -10, 0, 40)  -- è°ƒæ•´å¤§å°
cycleTeleportButton.Position = UDim2.new(0, 5, 0, 75)
cycleTeleportButton.Text = "è½®æµä¼ é€\nä¸‹ä¸€ä¸ªç©å®¶"
cycleTeleportButton.BackgroundColor3 = Color3.fromRGB(60, 100, 180)
cycleTeleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
cycleTeleportButton.Font = Enum.Font.SourceSansSemibold
cycleTeleportButton.TextSize = 14
cycleTeleportButton.TextWrapped = true
cycleTeleportButton.Parent = mainFrame

-- çŠ¶æ€æ˜¾ç¤ºï¼ˆç¼©å°åï¼‰
local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(1, -10, 1, -10)
statusLabel.Position = UDim2.new(0, 5, 0, 5)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "killaura\nç‚¹å‡»å±•å¼€"
statusLabel.TextColor3 = Color3.fromRGB(200, 200, 220)
statusLabel.TextSize = 12
statusLabel.TextWrapped = true
statusLabel.Visible = false
statusLabel.Parent = mainFrame

-- å˜é‡
local isComboActive = false  -- ä¸‰åˆä¸€çŠ¶æ€
local maxDistance = 200  -- å›ºå®šæœç´¢è·ç¦»
local teleportHeight = 0  -- å›ºå®šä¼ é€é«˜åº¦
local currentTarget = nil
local lastAttackTime = 0
local attackRate = 4  -- å›ºå®šæ”»å‡»é¢‘ç‡
local isMinimized = false
local originalSize = mainFrame.Size
local minimizedSize = UDim2.new(0, 80, 0, 40)  -- æ›´å°çš„ç¼©å°æ¨¡å¼
local minimizedPosition = UDim2.new(0.5, -40, 0.5, -20)
local ignoreHealthThreshold = 5  -- å¿½ç•¥è¡€é‡ä½äºæ­¤å€¼çš„ç©å®¶

-- è½®æµä¼ é€ç›¸å…³å˜é‡
local cycleTeleportIndex = 1  -- å½“å‰ä¼ é€çš„ç©å®¶ç´¢å¼•
local cycleTeleportPlayers = {}  -- å­˜å‚¨ç©å®¶åˆ—è¡¨
local cycleTeleportEnabled = false  -- è½®æµä¼ é€æ˜¯å¦å¯ç”¨

-- ç¼©å°åŠŸèƒ½
minimizeBtn.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized

    if isMinimized then
        mainFrame.Size = minimizedSize
        mainFrame.Position = minimizedPosition
        comboButton.Visible = false
        cycleTeleportButton.Visible = false
        statusLabel.Visible = true
        minimizeBtn.Text = "+"
        title.Text = "ğŸ¯"

        if isComboActive then
            statusLabel.Text = "killaura\nè¿è¡Œä¸­"
        else
            statusLabel.Text = "killaura\nå·²å…³é—­"
        end
    else
        mainFrame.Size = originalSize
        mainFrame.Position = UDim2.new(0.5, -60, 0.5, -70)
        comboButton.Visible = true
        cycleTeleportButton.Visible = true
        statusLabel.Visible = false
        minimizeBtn.Text = "_"
        title.Text = "killaura"
    end
end)

-- å…³é—­åŠŸèƒ½
closeBtn.MouseButton1Click:Connect(function()
    screenGui:Destroy()
    isRunning = false
end)

-- ä¸‰åˆä¸€æŒ‰é’®åŠŸèƒ½
comboButton.MouseButton1Click:Connect(function()
    isComboActive = not isComboActive

    if isComboActive then
        comboButton.Text = "ğŸŸ¢ å¼€å¯\næ€æˆ®å…‰ç¯"
        comboButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
        if isMinimized then
            statusLabel.Text = "killaura\nè¿è¡Œä¸­"
        end
    else
        comboButton.Text = "ğŸ”´ å…³é—­\næ€æˆ®å…‰ç¯"
        comboButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
        currentTarget = nil
        if isMinimized then
            statusLabel.Text = "killaura\nå·²å…³é—­"
        end
    end
end)

-- è·å–ç©å®¶å½“å‰è¡€é‡
local function getPlayerHealth(targetCharacter)
    local humanoid = targetCharacter:FindFirstChild("Humanoid")
    if humanoid then
        return humanoid.Health
    end
    return 100  -- å¦‚æœæ‰¾ä¸åˆ°Humanoidï¼Œé»˜è®¤è¿”å›100
end

-- è·å–æ‰€æœ‰æœ‰æ•ˆç©å®¶åˆ—è¡¨ï¼ˆå¿½ç•¥è¡€é‡ä½äº5çš„ï¼‰
local function getValidPlayers()
    local validPlayers = {}
    
    for _, otherPlayer in ipairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local otherRoot = otherPlayer.Character:FindFirstChild("HumanoidRootPart")
            if otherRoot then
                -- æ£€æŸ¥ç©å®¶è¡€é‡
                local health = getPlayerHealth(otherPlayer.Character)
                
                -- å¿½ç•¥è¡€é‡ä½äºé˜ˆå€¼çš„ç©å®¶
                if health >= ignoreHealthThreshold then
                    table.insert(validPlayers, {
                        Player = otherPlayer,
                        Character = otherPlayer.Character,
                        RootPart = otherRoot,
                        Health = health
                    })
                end
            end
        end
    end
    
    return validPlayers
end

-- è·å–æœ€è¿‘ç©å®¶ï¼ˆå¿½ç•¥è¡€é‡ä½äº5çš„ï¼‰
local function getNearestPlayer()
    local character = player.Character
    if not character then return nil end

    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return nil end

    local myPos = rootPart.Position
    local nearestPlayer = nil
    local nearestDistance = maxDistance

    local validPlayers = getValidPlayers()
    
    for _, targetInfo in ipairs(validPlayers) do
        local distance = (targetInfo.RootPart.Position - myPos).Magnitude
        if distance <= nearestDistance then
            nearestDistance = distance
            nearestPlayer = {
                Player = targetInfo.Player,
                Character = targetInfo.Character,
                Distance = distance,
                Position = targetInfo.RootPart.Position,
                Health = targetInfo.Health
            }
        end
    end

    return nearestPlayer
end

-- æ‰§è¡Œè½®æµä¼ é€
local function performCycleTeleport()
    local character = player.Character
    if not character then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    -- è·å–æœ‰æ•ˆç©å®¶åˆ—è¡¨
    cycleTeleportPlayers = getValidPlayers()
    
    if #cycleTeleportPlayers == 0 then
        if isMinimized then
            statusLabel.Text = "æ— æœ‰æ•ˆç©å®¶"
        else
            cycleTeleportButton.Text = "æ— æœ‰æ•ˆç©å®¶"
        end
        return
    end
    
    -- ç¡®ä¿ç´¢å¼•åœ¨æœ‰æ•ˆèŒƒå›´å†…
    if cycleTeleportIndex > #cycleTeleportPlayers then
        cycleTeleportIndex = 1
    end
    
    local targetInfo = cycleTeleportPlayers[cycleTeleportIndex]
    
    if targetInfo and targetInfo.RootPart then
        -- ä¼ é€åˆ°ç›®æ ‡ä½ç½®
        local teleportPos = targetInfo.RootPart.Position + Vector3.new(0, teleportHeight * 4, 0)
        humanoidRootPart.CFrame = CFrame.new(teleportPos)
        
        -- æ›´æ–°æŒ‰é’®æ˜¾ç¤º
        if not isMinimized then
            cycleTeleportButton.Text = string.format("ä¼ é€è‡³\n%s", targetInfo.Player.Name)
        end
        
        -- æ›´æ–°ç´¢å¼•åˆ°ä¸‹ä¸€ä¸ªç©å®¶
        cycleTeleportIndex = cycleTeleportIndex + 1
        if cycleTeleportIndex > #cycleTeleportPlayers then
            cycleTeleportIndex = 1
        end
        
        -- å¦‚æœå¤„äºç¼©å°æ¨¡å¼ï¼Œæ›´æ–°çŠ¶æ€
        if isMinimized then
            statusLabel.Text = string.format("ä¼ é€è‡³\n%s", targetInfo.Player.Name)
        end
        
        return targetInfo
    end
end

-- æ‰§è¡Œä¸‰åˆä¸€åŠŸèƒ½
local function performCombo()
    if not isComboActive then return false end

    local target = getNearestPlayer()
    currentTarget = target

    if target then
        -- æ˜¾ç¤ºç›®æ ‡è¡€é‡ï¼ˆä»…é™ç¼©å°æ¨¡å¼ï¼‰
        if isMinimized then
            statusLabel.Text = string.format("killaura\n%s HP:%.0f", 
                target.Player.Name, target.Health)
        end

        -- 1. è‡ªç„ï¼ˆç„å‡†å¤´éƒ¨ï¼‰
        local head = target.Character:FindFirstChild("Head")
        local aimPosition = head and head.Position or target.Position

        local cameraCFrame = camera.CFrame
        local targetDirection = (aimPosition - cameraCFrame.Position).Unit
        local currentLook = cameraCFrame.LookVector
        local smoothedDirection = currentLook:Lerp(targetDirection, 0.5)
        camera.CFrame = CFrame.new(cameraCFrame.Position, cameraCFrame.Position + smoothedDirection)

        -- 2. ä¼ é€ï¼ˆåˆ°ç›®æ ‡ä½ç½®ï¼Œé«˜åº¦ä¸º0ï¼‰
        local character = player.Character
        if character then
            local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
            if humanoidRootPart then
                local teleportPos = target.Position + Vector3.new(0, teleportHeight * 4, 0)
                humanoidRootPart.CFrame = CFrame.new(teleportPos)
            end
        end

        -- 3. æ”»å‡»ï¼ˆè‡ªåŠ¨å·¦é”®ï¼‰
        local currentTime = tick()
        if currentTime - lastAttackTime >= (1 / attackRate) then
            pcall(function()
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 1)
                task.wait(0.05)
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 1)
            end)
            lastAttackTime = currentTime
        end

        return true
    else
        if isMinimized then
            statusLabel.Text = "killaura\næ— æœ‰æ•ˆç›®æ ‡"
        end
        return false
    end
end

-- è½®æµä¼ é€æŒ‰é’®ç‚¹å‡»äº‹ä»¶
cycleTeleportButton.MouseButton1Click:Connect(function()
    performCycleTeleport()
end)

-- ä¸»å¾ªç¯
RunService.Heartbeat:Connect(function()
    if not isRunning then return end
    performCombo()
end)

-- å¿«æ·é”®
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end

    -- ç©ºæ ¼é”®ï¼šå¼€å…³ä¸‰åˆä¸€
    if input.KeyCode == Enum.KeyCode.Space then
        isComboActive = not isComboActive

        if isComboActive then
            comboButton.Text = "ğŸŸ¢ å¼€å¯\næ€æˆ®å…‰ç¯"
            comboButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
            if isMinimized then
                statusLabel.Text = "killaura\nè¿è¡Œä¸­"
            end
        else
            comboButton.Text = "ğŸ”´ å…³é—­\næ€æˆ®å…‰ç¯"
            comboButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
            currentTarget = nil
            if isMinimized then
                statusLabel.Text = "killaura\nå·²å…³é—­"
            end
        end
    end

    -- Té”®ï¼šè§¦å‘è½®æµä¼ é€
    if input.KeyCode == Enum.KeyCode.T then
        performCycleTeleport()
    end

    -- Mé”®ï¼šç¼©å°/æ”¾å¤§
    if input.KeyCode == Enum.KeyCode.M then
        isMinimized = not isMinimized

        if isMinimized then
            mainFrame.Size = minimizedSize
            mainFrame.Position = minimizedPosition
            comboButton.Visible = false
            cycleTeleportButton.Visible = false
            statusLabel.Visible = true
            minimizeBtn.Text = "+"
            title.Text = "æ¸”ç‚’é±¼"

            if isComboActive then
                statusLabel.Text = "killaura\nè¿è¡Œä¸­"
            else
                statusLabel.Text = "killaura\nå·²å…³é—­"
            end
        else
            mainFrame.Size = originalSize
            mainFrame.Position = UDim2.new(0.5, -60, 0.5, -70)
            comboButton.Visible = true
            cycleTeleportButton.Visible = true
            statusLabel.Visible = false
            minimizeBtn.Text = "_"
            title.Text = "killaura"
        end
    end
end)

print("=== killauraè„šæœ¬å·²åŠ è½½ ===")
print("åŠŸèƒ½:")
print("- è‡ªç„+ä¼ é€+æ”»å‡» (å¿½ç•¥è¡€é‡<5çš„ç©å®¶)")
print("- è½®æµä¼ é€æ‰€æœ‰ç©å®¶")
print("æ“ä½œ:")
print("- ç‚¹å‡»æŒ‰é’®æˆ–æŒ‰ç©ºæ ¼é”®å¼€å…³æ€æˆ®å…‰ç¯")
print("- ç‚¹å‡»æŒ‰é’®æˆ–æŒ‰Té”®è½®æµä¼ é€")
print("- ç‚¹å‡»_æŒ‰é’®æˆ–æŒ‰Mé”®ç¼©å°")
print("å‚æ•°:")
print("- æœç´¢è·ç¦»: 200ç±³")
print("- ä¼ é€é«˜åº¦: 0æ ¼ (ç›¸åŒé«˜åº¦)")
print("- æ”»å‡»é¢‘ç‡: 4æ¬¡/ç§’")
print("- å¿½ç•¥è¡€é‡: <5çš„ç©å®¶")
print("çŠ¶æ€: å°±ç»ª")