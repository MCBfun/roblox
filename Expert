-- Expert
local SoundService = game:GetService("SoundService")

-- åˆ›å»ºéŸ³é¢‘å®ä¾‹
local sound = Instance.new("Sound")
sound.SoundId = "rbxassetid://7390036132"  -- æ›¿æ¢ä¸ºä½ çš„éŸ³é¢‘ID
sound.Parent = SoundService

-- æ’­æ”¾éŸ³é¢‘
sound:Play()
-- Expert - ç­‰å€™å…ä¼ é€è„šæœ¬
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local isRunning = true

-- åˆ›å»ºæœ€å°åŒ–UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ExpertGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 120, 0, 295)
mainFrame.Position = UDim2.new(0.02, 0, 0.3, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)  -- æ”¹ä¸ºæ·±ç°è‰²
mainFrame.BackgroundTransparency = 0.1
mainFrame.BorderSizePixel = 1
mainFrame.BorderColor3 = Color3.fromRGB(60, 60, 70)  -- æ”¹ä¸ºæ·±ç°è‰²è¾¹æ¡†
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

-- åœ†è§’æ•ˆæœ
local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 6)
uiCorner.Parent = mainFrame

-- æ ‡é¢˜æ 
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 25)
titleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 25)  -- æ”¹ä¸ºæ·±ç°è‰²
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

-- æ ‡é¢˜æ åœ†è§’
local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 6)
titleCorner.Parent = titleBar

local title = Instance.new("TextLabel")
title.Text = "Expert"
title.Size = UDim2.new(1, -80, 1, 0)
title.Position = UDim2.new(0, 5, 0, 0)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
title.TextXAlignment = Enum.TextXAlignment.Left
title.Font = Enum.Font.SourceSansSemibold
title.TextSize = 14
title.Parent = titleBar

-- æ§åˆ¶æŒ‰é’®å®¹å™¨
local controlButtons = Instance.new("Frame")
controlButtons.Name = "ControlButtons"
controlButtons.Size = UDim2.new(0, 75, 1, 0)
controlButtons.Position = UDim2.new(1, -75, 0, 0)
controlButtons.BackgroundTransparency = 1
controlButtons.Parent = titleBar

-- ç¼©æ”¾æŒ‰é’®
local zoomBtn = Instance.new("TextButton")
zoomBtn.Name = "ZoomButton"
zoomBtn.Size = UDim2.new(0, 25, 0, 25)
zoomBtn.Position = UDim2.new(0, 0, 0, 0)
zoomBtn.Text = "âºï¸"
zoomBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 45)  -- æ”¹ä¸ºæ·±ç°è‰²
zoomBtn.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
zoomBtn.Font = Enum.Font.SourceSansBold
zoomBtn.TextSize = 14
zoomBtn.AutoButtonColor = false
zoomBtn.Parent = controlButtons

local zoomCorner = Instance.new("UICorner")
zoomCorner.CornerRadius = UDim.new(0, 4)
zoomCorner.Parent = zoomBtn

-- ç¼©å°æŒ‰é’®
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Name = "MinimizeButton"
minimizeBtn.Size = UDim2.new(0, 25, 0, 25)
minimizeBtn.Position = UDim2.new(0, 25, 0, 0)
minimizeBtn.Text = "_"
minimizeBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 45)  -- æ”¹ä¸ºæ·±ç°è‰²
minimizeBtn.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
minimizeBtn.Font = Enum.Font.SourceSansBold
minimizeBtn.TextSize = 16
minimizeBtn.AutoButtonColor = false
minimizeBtn.Parent = controlButtons

local minimizeCorner = Instance.new("UICorner")
minimizeCorner.CornerRadius = UDim.new(0, 4)
minimizeCorner.Parent = minimizeBtn

-- å…³é—­æŒ‰é’®
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 25, 0, 25)
closeBtn.Position = UDim2.new(0, 50, 0, 0)
closeBtn.Text = "Ã—"
closeBtn.BackgroundColor3 = Color3.fromRGB(45, 35, 35)  -- æ”¹ä¸ºæ·±ç°è‰²åçº¢
closeBtn.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 16
closeBtn.AutoButtonColor = false
closeBtn.Parent = controlButtons

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 4)
closeCorner.Parent = closeBtn

-- ç­‰å€™å…ä¼ é€æŒ‰é’®
local backroomTeleportButton = Instance.new("TextButton")
backroomTeleportButton.Name = "BackroomTeleportButton"
backroomTeleportButton.Size = UDim2.new(1, -10, 0, 40)
backroomTeleportButton.Position = UDim2.new(0, 5, 0, 30)
backroomTeleportButton.Text = "ä¼ é€ç­‰å€™å…"
backroomTeleportButton.BackgroundColor3 = Color3.fromRGB(35, 35, 40)  -- æ”¹ä¸ºæ·±ç°è‰²
backroomTeleportButton.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
backroomTeleportButton.Font = Enum.Font.SourceSansSemibold
backroomTeleportButton.TextSize = 14
backroomTeleportButton.TextWrapped = true
backroomTeleportButton.AutoButtonColor = false
backroomTeleportButton.Parent = mainFrame

local teleportCorner = Instance.new("UICorner")
teleportCorner.CornerRadius = UDim.new(0, 5)
teleportCorner.Parent = backroomTeleportButton

-- å‰§é™¢|å·¥å‚ç«è½¦ä¼ é€æŒ‰é’®ï¼ˆåˆå¹¶ï¼‰
local theaterFactoryButton = Instance.new("TextButton")
theaterFactoryButton.Name = "TheaterFactoryButton"
theaterFactoryButton.Size = UDim2.new(1, -10, 0, 40)
theaterFactoryButton.Position = UDim2.new(0, 5, 0, 75)
theaterFactoryButton.Text = "ä¼ é€åˆ°å‰§é™¢|å·¥å‚"
theaterFactoryButton.BackgroundColor3 = Color3.fromRGB(35, 35, 40)  -- æ”¹ä¸ºæ·±ç°è‰²
theaterFactoryButton.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
theaterFactoryButton.Font = Enum.Font.SourceSansSemibold
theaterFactoryButton.TextSize = 14
theaterFactoryButton.TextWrapped = true
theaterFactoryButton.AutoButtonColor = false
theaterFactoryButton.Parent = mainFrame

local theaterFactoryCorner = Instance.new("UICorner")
theaterFactoryCorner.CornerRadius = UDim.new(0, 5)
theaterFactoryCorner.Parent = theaterFactoryButton

-- ä¸‹æ°´é“ä¼ é€æŒ‰é’®
local sewerTeleportButton = Instance.new("TextButton")
sewerTeleportButton.Name = "SewerTeleportButton"
sewerTeleportButton.Size = UDim2.new(1, -10, 0, 40)
sewerTeleportButton.Position = UDim2.new(0, 5, 0, 120)
sewerTeleportButton.Text = "ä¼ é€ä¸‹æ°´é“"
sewerTeleportButton.BackgroundColor3 = Color3.fromRGB(35, 35, 40)  -- æ”¹ä¸ºæ·±ç°è‰²
sewerTeleportButton.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
sewerTeleportButton.Font = Enum.Font.SourceSansSemibold
sewerTeleportButton.TextSize = 14
sewerTeleportButton.TextWrapped = true
sewerTeleportButton.AutoButtonColor = false
sewerTeleportButton.Parent = mainFrame

local sewerCorner = Instance.new("UICorner")
sewerCorner.CornerRadius = UDim.new(0, 5)
sewerCorner.Parent = sewerTeleportButton

-- è‡ªæ•‘åŠŸèƒ½æŒ‰é’®
local selfRescueButton = Instance.new("TextButton")
selfRescueButton.Name = "SelfRescueButton"
selfRescueButton.Size = UDim2.new(1, -10, 0, 40)
selfRescueButton.Position = UDim2.new(0, 5, 0, 165)
selfRescueButton.Text = "è‡ªæ•‘\nå›ºå®šä½ç½® [å…³]"
selfRescueButton.BackgroundColor3 = Color3.fromRGB(35, 35, 40)  -- æ”¹ä¸ºæ·±ç°è‰²
selfRescueButton.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
selfRescueButton.Font = Enum.Font.SourceSansSemibold
selfRescueButton.TextSize = 14
selfRescueButton.TextWrapped = true
selfRescueButton.AutoButtonColor = false
selfRescueButton.Parent = mainFrame

local selfRescueCorner = Instance.new("UICorner")
selfRescueCorner.CornerRadius = UDim.new(0, 5)
selfRescueCorner.Parent = selfRescueButton

-- ä»™äººæ¨¡å¼æŒ‰é’®
local ninjaModeButton = Instance.new("TextButton")
ninjaModeButton.Name = "NinjaModeButton"
ninjaModeButton.Size = UDim2.new(1, -10, 0, 40)
ninjaModeButton.Position = UDim2.new(0, 5, 0, 210)
ninjaModeButton.Text = "ä»™äººæ¨¡å¼\n[å…³]"
ninjaModeButton.BackgroundColor3 = Color3.fromRGB(35, 35, 40)  -- æ”¹ä¸ºæ·±ç°è‰²
ninjaModeButton.TextColor3 = Color3.fromRGB(220, 220, 220)  -- æ”¹ä¸ºæµ…ç°è‰²
ninjaModeButton.Font = Enum.Font.SourceSansSemibold
ninjaModeButton.TextSize = 14
ninjaModeButton.TextWrapped = true
ninjaModeButton.AutoButtonColor = false
ninjaModeButton.Parent = mainFrame

local ninjaModeCorner = Instance.new("UICorner")
ninjaModeCorner.CornerRadius = UDim.new(0, 5)
ninjaModeCorner.Parent = ninjaModeButton

-- çŠ¶æ€æ˜¾ç¤ºï¼ˆç¼©å°åï¼‰
local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(1, -10, 1, -10)
statusLabel.Position = UDim2.new(0, 5, 0, 5)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "Expert\nç‚¹å‡»å±•å¼€"
statusLabel.TextColor3 = Color3.fromRGB(180, 180, 180)  -- æ”¹ä¸ºç°è‰²
statusLabel.TextSize = 12
statusLabel.TextWrapped = true
statusLabel.Visible = false
statusLabel.Parent = mainFrame

-- å˜é‡
local isMinimized = false
local isZoomed = false
local originalSize = mainFrame.Size
local originalPosition = mainFrame.Position
local minimizedSize = UDim2.new(0, 80, 0, 40)
local zoomedSize = UDim2.new(0, 140, 0, 305)

-- è‡ªæ•‘åŠŸèƒ½ç›¸å…³å˜é‡
local isSelfRescueActive = false
local selfRescueConnection = nil
local savedPosition = nil
local savedCFrame = nil

-- ä»™äººæ¨¡å¼ç›¸å…³å˜é‡
local isNinjaModeActive = false
local originalWalkSpeed = 16
local originalJumpPower = 50
local ninjaModeMultiplier = 2.5
local infiniteJumpEnabled = false
local ninjaModeConnection = nil

-- åæ ‡å®šä¹‰
local backroomLocation = {X = 163.15, Y = 9, Z = 955.4}
local theaterFactoryLocation = {X = 0, Y = -297, Z = 0}  -- Y-297ä½ç½®
local sewerLocation = {X = 356, Y = 528, Z = -179}

-- æŒ‰é’®æ‚¬åœæ•ˆæœå‡½æ•°ï¼ˆé»‘ç™½é£æ ¼ï¼‰
local function setupButtonHover(button)
    local originalColor = button.BackgroundColor3
    local originalTextColor = button.TextColor3
    button.MouseEnter:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(
            math.min(originalColor.R * 255 + 15, 55),
            math.min(originalColor.G * 255 + 15, 55),
            math.min(originalColor.B * 255 + 15, 55)
        ) / 255
        button.TextColor3 = Color3.fromRGB(240, 240, 240)  -- æ›´äº®çš„ç°è‰²
    end)
    button.MouseLeave:Connect(function()
        button.BackgroundColor3 = originalColor
        button.TextColor3 = originalTextColor
    end)
end

setupButtonHover(backroomTeleportButton)
setupButtonHover(theaterFactoryButton)
setupButtonHover(sewerTeleportButton)
setupButtonHover(selfRescueButton)
setupButtonHover(ninjaModeButton)
setupButtonHover(zoomBtn)
setupButtonHover(minimizeBtn)
setupButtonHover(closeBtn)

-- è‡ªæ•‘åŠŸèƒ½
local function startSelfRescue()
    if isSelfRescueActive then return end
    
    local character = player.Character
    if not character then return false end

    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return false end

    savedPosition = humanoidRootPart.Position
    savedCFrame = humanoidRootPart.CFrame
    isSelfRescueActive = true
    selfRescueButton.Text = "è‡ªæ•‘\nå›ºå®šä½ç½® [å¼€]"

    local bodyPosition = Instance.new("BodyPosition")
    bodyPosition.Name = "ExpertSelfRescuePosition"
    bodyPosition.P = 100000
    bodyPosition.D = 1000
    bodyPosition.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
    bodyPosition.Position = savedPosition
    bodyPosition.Parent = humanoidRootPart

    local humanoid = character:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = 0
        humanoid.JumpPower = 0
    end

    selfRescueConnection = RunService.Heartbeat:Connect(function()
        if not isSelfRescueActive or not character or character.Parent == nil then
            stopSelfRescue()
            return
        end
        local currentRootPart = character:FindFirstChild("HumanoidRootPart")
        if not currentRootPart then return end
        currentRootPart.CFrame = savedCFrame
        local existingBodyPosition = currentRootPart:FindFirstChild("ExpertSelfRescuePosition")
        if existingBodyPosition then
            existingBodyPosition.Position = savedPosition
        else
            local newBodyPosition = Instance.new("BodyPosition")
            newBodyPosition.Name = "ExpertSelfRescuePosition"
            newBodyPosition.P = 100000
            newBodyPosition.D = 1000
            newBodyPosition.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
            newBodyPosition.Position = savedPosition
            newBodyPosition.Parent = currentRootPart
        end
    end)
    
    if isMinimized then statusLabel.Text = "ğŸ”’ å·²å›ºå®šä½ç½®" end
    return true
end

local function stopSelfRescue()
    if not isSelfRescueActive then return end
    isSelfRescueActive = false
    if selfRescueConnection then
        selfRescueConnection:Disconnect()
        selfRescueConnection = nil
    end
    
    local character = player.Character
    if character then
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        if humanoidRootPart then
            local bodyPosition = humanoidRootPart:FindFirstChild("ExpertSelfRescuePosition")
            if bodyPosition then bodyPosition:Destroy() end
        end
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = 16
            humanoid.JumpPower = 50
        end
    end
    
    selfRescueButton.Text = "è‡ªæ•‘\nå›ºå®šä½ç½® [å…³]"
    if isMinimized then statusLabel.Text = "Expert\nç‚¹å‡»å±•å¼€" end
    savedPosition = nil
    savedCFrame = nil
end

-- é€šç”¨ä¼ é€å‡½æ•°
local function performTeleport(location, button, locationName)
    if isSelfRescueActive then stopSelfRescue() end
    
    local character = player.Character
    if not character then return false end

    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return false end

    local teleportPos = Vector3.new(location.X, location.Y, location.Z)
    humanoidRootPart.CFrame = CFrame.new(teleportPos)

    if not isMinimized and button then
        local originalText = button.Text
        button.Text = "âœ… å·²ä¼ é€"
        task.wait(2)
        button.Text = originalText
    end

    if isMinimized then
        statusLabel.Text = "âœ… å·²ä¼ é€" .. locationName
        task.wait(2)
        statusLabel.Text = "Expert\nç‚¹å‡»å±•å¼€"
    end

    return true
end

-- æ‰§è¡Œç­‰å€™å…ä¼ é€
local function performBackroomTeleport()
    return performTeleport(backroomLocation, backroomTeleportButton, "ç­‰å€™å…")
end

-- æ‰§è¡Œå‰§é™¢|å·¥å‚ä¼ é€ï¼ˆY-297ï¼‰
local function performTheaterFactoryTeleport()
    return performTeleport(theaterFactoryLocation, theaterFactoryButton, "å‰§é™¢|å·¥å‚")
end

-- æ‰§è¡Œä¸‹æ°´é“ä¼ é€
local function performSewerTeleport()
    return performTeleport(sewerLocation, sewerTeleportButton, "ä¸‹æ°´é“")
end

-- ä»™äººæ¨¡å¼åŠŸèƒ½
local function startNinjaMode()
    if isNinjaModeActive then return end
    
    local character = player.Character
    if not character then return false end

    local humanoid = character:FindFirstChild("Humanoid")
    if not humanoid then return false end

    originalWalkSpeed = humanoid.WalkSpeed
    originalJumpPower = humanoid.JumpPower
    isNinjaModeActive = true
    infiniteJumpEnabled = true
    ninjaModeButton.Text = "ä»™äººæ¨¡å¼\n[å¼€]"
    
    humanoid.WalkSpeed = originalWalkSpeed * ninjaModeMultiplier
    humanoid.JumpPower = originalJumpPower * 3

    ninjaModeConnection = UserInputService.JumpRequest:Connect(function()
        if infiniteJumpEnabled and character and character:FindFirstChild("Humanoid") then
            character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end)
    
    if isMinimized then statusLabel.Text = "âš¡ ä»™äººæ¨¡å¼" end
    return true
end

local function stopNinjaMode()
    if not isNinjaModeActive then return end
    isNinjaModeActive = false
    infiniteJumpEnabled = false
    
    if ninjaModeConnection then
        ninjaModeConnection:Disconnect()
        ninjaModeConnection = nil
    end
    
    local character = player.Character
    if character then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = originalWalkSpeed
            humanoid.JumpPower = originalJumpPower
        end
    end
    
    ninjaModeButton.Text = "ä»™äººæ¨¡å¼\n[å…³]"
    if isMinimized then statusLabel.Text = "Expert\nç‚¹å‡»å±•å¼€" end
end

-- æŒ‰é’®ç‚¹å‡»äº‹ä»¶
backroomTeleportButton.MouseButton1Click:Connect(performBackroomTeleport)
theaterFactoryButton.MouseButton1Click:Connect(performTheaterFactoryTeleport)
sewerTeleportButton.MouseButton1Click:Connect(performSewerTeleport)
selfRescueButton.MouseButton1Click:Connect(function()
    if isSelfRescueActive then stopSelfRescue() else startSelfRescue() end
end)
ninjaModeButton.MouseButton1Click:Connect(function()
    if isNinjaModeActive then stopNinjaMode() else startNinjaMode() end
end)

-- ç¼©æ”¾åŠŸèƒ½
zoomBtn.MouseButton1Click:Connect(function()
    isZoomed = not isZoomed
    if isZoomed then
        local currentPos = mainFrame.Position
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {
            Size = zoomedSize, Position = currentPos
        })
        tween:Play()
        zoomBtn.Text = "âº"
    else
        local currentPos = mainFrame.Position
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {
            Size = originalSize, Position = currentPos
        })
        tween:Play()
        zoomBtn.Text = "âºï¸"
    end
end)

-- ç¼©å°åŠŸèƒ½
minimizeBtn.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    if isMinimized then
        local currentPos = mainFrame.Position
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {
            Size = minimizedSize, Position = currentPos
        })
        tween:Play()
        tween.Completed:Wait()
        backroomTeleportButton.Visible = false
        theaterFactoryButton.Visible = false
        sewerTeleportButton.Visible = false
        selfRescueButton.Visible = false
        ninjaModeButton.Visible = false
        statusLabel.Visible = true
        minimizeBtn.Text = "+"
        title.Text = "âš”"
        if isSelfRescueActive then
            statusLabel.Text = "ğŸ”’ å›ºå®šä½ç½®"
        elseif isNinjaModeActive then
            statusLabel.Text = "âš¡ ä»™äººæ¨¡å¼"
        else
            statusLabel.Text = "Expert\nç‚¹å‡»å±•å¼€"
        end
    else
        backroomTeleportButton.Visible = true
        theaterFactoryButton.Visible = true
        sewerTeleportButton.Visible = true
        selfRescueButton.Visible = true
        ninjaModeButton.Visible = true
        statusLabel.Visible = false
        minimizeBtn.Text = "_"
        title.Text = "Expert"
        local currentPos = mainFrame.Position
        local targetSize = isZoomed and zoomedSize or originalSize
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {
            Size = targetSize, Position = currentPos
        })
        tween:Play()
    end
end)

-- å…³é—­åŠŸèƒ½
closeBtn.MouseButton1Click:Connect(function()
    if isSelfRescueActive then stopSelfRescue() end
    if isNinjaModeActive then stopNinjaMode() end
    local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {
        BackgroundTransparency = 0.8,
        Position = mainFrame.Position + UDim2.new(0, 0, 0, -20)
    })
    tween:Play()
    tween.Completed:Wait()
    screenGui:Destroy()
    isRunning = false
end)

-- å¿«æ·é”®
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.B then performBackroomTeleport()
    elseif input.KeyCode == Enum.KeyCode.T then performTheaterFactoryTeleport()
    elseif input.KeyCode == Enum.KeyCode.S then performSewerTeleport()
    elseif input.KeyCode == Enum.KeyCode.R then
        if isSelfRescueActive then stopSelfRescue() else startSelfRescue() end
    elseif input.KeyCode == Enum.KeyCode.N then
        if isNinjaModeActive then stopNinjaMode() else startNinjaMode() end
    end
end)

-- è§’è‰²é‡ç”Ÿå¤„ç†
player.CharacterAdded:Connect(function(character)
    if isSelfRescueActive then stopSelfRescue() end
    if isNinjaModeActive then
        task.wait(0.5)
        if isNinjaModeActive then
            local humanoid = character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = originalWalkSpeed * ninjaModeMultiplier
                humanoid.JumpPower = originalJumpPower * 3
                if ninjaModeConnection then ninjaModeConnection:Disconnect() end
                ninjaModeConnection = UserInputService.JumpRequest:Connect(function()
                    if infiniteJumpEnabled and character and character:FindFirstChild("Humanoid") then
                        character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                    end
                end)
            end
        end
    end
end)

-- åˆå§‹æ·¡å…¥åŠ¨ç”»
local originalPosition = UDim2.new(0.02, 0, 0.3, 0)
mainFrame.BackgroundTransparency = 1
mainFrame.Position = originalPosition + UDim2.new(0, 0, 0, -30)
task.wait(0.1)
local fadeInTween = TweenService:Create(mainFrame, TweenInfo.new(0.5), {
    BackgroundTransparency = 0.1, Position = originalPosition
})
fadeInTween:Play()

game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Expert",
    Text = "è„šæœ¬å·²åŠ è½½ - B/T/S/R/Né”®",
    Duration = 3,
    Position = UDim2.new(0, 20, 1, -50)
})